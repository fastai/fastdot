---

title: fastgraph.pagegraph
keywords: fastai
sidebar: home_sidebar

summary: "David's stuff!"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_pagegraph.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Drawing-graphs">Drawing graphs<a class="anchor-link" href="#Drawing-graphs">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split" class="doc_header"><code>split</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split</code>(<strong><code>path</code></strong>, <strong><code>sep</code></strong>=<em><code>'/'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_dot_graph" class="doc_header"><code>make_dot_graph</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_dot_graph</code>(<strong><code>nodes</code></strong>, <strong><code>edges</code></strong>, <strong><code>direction</code></strong>=<em><code>'LR'</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_dict" class="doc_header"><code>to_dict</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L38" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_dict</code>(<strong><code>inputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="DotGraph" class="doc_header"><code>class</code> <code>DotGraph</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L42" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>DotGraph</code>(<strong><code>graph</code></strong>, <strong><code>size</code></strong>=<em><code>None</code></em>, <strong><code>direction</code></strong>=<em><code>'LR'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's define a compact way of representing directed graphs (suitable for describing neural networks) as python dictionaries. Each node has a <em>name</em> which should be a string, a <em>value</em> which can be anything and an (ordered) list of <em>inputs</em> representing incoming edges from other nodes. Inputs are ordered as they typically represent function args. We can alternatively provide a dict of <em>inputs</em> to represent named args. Here is our graph format:</p>

<pre><code>Graph := {name: (value, [input])}</code></pre>
<p>or</p>

<pre><code>Graph := {name: (value, {input_name: input}}</code></pre>
<p>Here is an example of such a Graph using both kinds of inputs:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#define some node values - just strings for now we&#39;ll use more interesting values later</span>
<span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="s1">&#39;Aa Bb Cc Dd&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="n">graph</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">[]),</span>
    <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">}),</span>
    <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It will be useful to be able to display Graphs. Here is a function that does that:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="draw_graph" class="doc_header"><code>draw_graph</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L60" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>draw_graph</code>(<strong><code>graph</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">draw_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: G Pages: 1 -->
<svg width="242pt" height="116pt"
 viewBox="0.00 0.00 242.00 116.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>G</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-112 238,-112 238,4 -4,4"/>
<!-- a -->
<g id="node1" class="node">
<title>a</title>
<g id="a_node1"><a xlink:title="Aa">
<path fill="#ffffff" stroke="#000000" d="M42,-72C42,-72 12,-72 12,-72 6,-72 0,-66 0,-60 0,-60 0,-48 0,-48 0,-42 6,-36 12,-36 12,-36 42,-36 42,-36 48,-36 54,-42 54,-48 54,-48 54,-60 54,-60 54,-66 48,-72 42,-72"/>
<text text-anchor="middle" x="27" y="-50.3" font-family="Times,serif" font-size="14.00" fill="#000000">a</text>
</a>
</g>
</g>
<!-- b -->
<g id="node2" class="node">
<title>b</title>
<g id="a_node2"><a xlink:title="Bb">
<path fill="#ffffff" stroke="#000000" d="M132,-108C132,-108 102,-108 102,-108 96,-108 90,-102 90,-96 90,-96 90,-84 90,-84 90,-78 96,-72 102,-72 102,-72 132,-72 132,-72 138,-72 144,-78 144,-84 144,-84 144,-96 144,-96 144,-102 138,-108 132,-108"/>
<text text-anchor="middle" x="117" y="-86.3" font-family="Times,serif" font-size="14.00" fill="#000000">b</text>
</a>
</g>
</g>
<!-- a&#45;&gt;b -->
<g id="edge1" class="edge">
<title>a&#45;&gt;b</title>
<g id="a_edge1"><a xlink:title="0">
<path fill="none" stroke="#000000" d="M54.003,-64.8012C62.2922,-68.1169 71.5569,-71.8228 80.3766,-75.3506"/>
<polygon fill="#000000" stroke="#000000" points="79.1204,-78.6177 89.705,-79.082 81.7201,-72.1184 79.1204,-78.6177"/>
</a>
</g>
</g>
<!-- c -->
<g id="node3" class="node">
<title>c</title>
<g id="a_node3"><a xlink:title="Cc">
<path fill="#ffffff" stroke="#000000" d="M132,-36C132,-36 102,-36 102,-36 96,-36 90,-30 90,-24 90,-24 90,-12 90,-12 90,-6 96,0 102,0 102,0 132,0 132,0 138,0 144,-6 144,-12 144,-12 144,-24 144,-24 144,-30 138,-36 132,-36"/>
<text text-anchor="middle" x="117" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">c</text>
</a>
</g>
</g>
<!-- a&#45;&gt;c -->
<g id="edge2" class="edge">
<title>a&#45;&gt;c</title>
<g id="a_edge2"><a xlink:title="x">
<path fill="none" stroke="#000000" d="M54.003,-43.1988C62.2922,-39.8831 71.5569,-36.1772 80.3766,-32.6494"/>
<polygon fill="#000000" stroke="#000000" points="81.7201,-35.8816 89.705,-28.918 79.1204,-29.3823 81.7201,-35.8816"/>
</a>
</g>
</g>
<!-- d -->
<g id="node4" class="node">
<title>d</title>
<g id="a_node4"><a xlink:title="Dd">
<path fill="#ffffff" stroke="#000000" d="M222,-108C222,-108 192,-108 192,-108 186,-108 180,-102 180,-96 180,-96 180,-84 180,-84 180,-78 186,-72 192,-72 192,-72 222,-72 222,-72 228,-72 234,-78 234,-84 234,-84 234,-96 234,-96 234,-102 228,-108 222,-108"/>
<text text-anchor="middle" x="207" y="-86.3" font-family="Times,serif" font-size="14.00" fill="#000000">d</text>
</a>
</g>
</g>
<!-- b&#45;&gt;d -->
<g id="edge4" class="edge">
<title>b&#45;&gt;d</title>
<g id="a_edge4"><a xlink:title="0">
<path fill="none" stroke="#000000" d="M144.003,-90C152.0277,-90 160.9665,-90 169.5309,-90"/>
<polygon fill="#000000" stroke="#000000" points="169.7051,-93.5001 179.705,-90 169.705,-86.5001 169.7051,-93.5001"/>
</a>
</g>
</g>
<!-- c&#45;&gt;c -->
<g id="edge3" class="edge">
<title>c&#45;&gt;c</title>
<g id="a_edge3"><a xlink:title="y">
<path fill="none" stroke="#000000" d="M100.7183,-36.1527C98.2134,-45.5391 103.6406,-54 117,-54 125.1409,-54 130.3362,-50.8581 132.5861,-46.2796"/>
<polygon fill="#000000" stroke="#000000" points="136.0881,-46.3691 133.2817,-36.1527 129.1046,-45.8893 136.0881,-46.3691"/>
</a>
</g>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exploding-graphs">Exploding graphs<a class="anchor-link" href="#Exploding-graphs">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="iter_nodes" class="doc_header"><code>iter_nodes</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>iter_nodes</code>(<strong><code>graph</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bindings" class="doc_header"><code>bindings</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bindings</code>(<strong><code>graph</code></strong>, <strong><code>inputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_graph" class="doc_header"><code>to_graph</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_graph</code>(<strong><code>value</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="maybe_graph" class="doc_header"><code>maybe_graph</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L99" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>maybe_graph</code>(<strong><code>x</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="explode" class="doc_header"><code>explode</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L104" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>explode</code>(<strong><code>graph</code></strong>, <strong><code>max_levels</code></strong>=<em><code>-1</code></em>, <strong><code>convert</code></strong>=<em><code>'maybe_graph'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creating-Networks">Creating Networks<a class="anchor-link" href="#Creating-Networks">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="ColorMap" class="doc_header"><code>class</code> <code>ColorMap</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L126" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>ColorMap</code>() :: <code>dict</code></p>
</blockquote>
<p>dict() -&gt; new empty dictionary
dict(mapping) -&gt; new dictionary initialized from a mapping object's
    (key, value) pairs
dict(iterable) -&gt; new dictionary initialized as if via:
    d = {}
    for k, v in iterable:
        d[k] = v
dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs
    in the keyword argument list.  For example:  dict(one=1, two=2)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Network" class="doc_header"><code>class</code> <code>Network</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L150" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>Network</code>(<strong><code>graph</code></strong>, <strong><code>cache_activations</code></strong>=<em><code>False</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super(Model, self).__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_network" class="doc_header"><code>to_network</code><a href="https://github.com/fastai/fastgraph/tree/master/fastgraph/pagegraph.py#L182" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_network</code>(<strong><code>module</code></strong>, <strong><code>max_levels</code></strong>=<em><code>-1</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span>
<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_core.ipynb.
Converted index.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 

