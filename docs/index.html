---

title: fastdot


keywords: fastai
sidebar: home_sidebar

summary: "A simple wrapper over `pydot` to make it more consistent, unsurprising, and pythonic"
description: "A simple wrapper over `pydot` to make it more consistent, unsurprising, and pythonic"
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Acknowledgement: <code>fastdot</code> is heavily influenced by work from <a href="https://github.com/davidcpage/">David Page</a>, who built a system for drawing graphs based on a highly flexible data structure he designed. It may turn out that his library, when complete, will make it even easier to do the things described here (and his data structure also supports a lot more than just drawing)!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pre-Install">Pre-Install<a class="anchor-link" href="#Pre-Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Ubuntu">Ubuntu<a class="anchor-link" href="#Ubuntu"> </a></h3><p><code>sudo apt-get install -y python-pydot python-pydot-ng graphviz</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install fastdot</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Synopsis">Synopsis<a class="anchor-link" href="#Synopsis"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Start with some data representing objects and connections between them (e.g. they wouldn't normally be just strings like in this example, but would be neural net layers, or users and products, or car trips, etc):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">layers1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span><span class="s1">&#39;lin&#39;</span><span class="p">]</span>
<span class="n">layers2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span><span class="s1">&#39;lin&#39;</span><span class="p">]</span>
<span class="n">block1</span><span class="p">,</span><span class="n">block2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;block1&#39;</span><span class="p">,</span><span class="s1">&#39;block2&#39;</span><span class="p">]</span>
<span class="n">conns</span> <span class="o">=</span> <span class="p">((</span><span class="n">block1</span><span class="p">,</span> <span class="n">block2</span><span class="p">),</span>
         <span class="p">(</span><span class="n">block1</span><span class="p">,</span> <span class="n">layers2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then map them directly to a visual respresentation:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">graph_items</span><span class="p">(</span><span class="n">seq_cluster</span><span class="p">(</span><span class="n">layers1</span><span class="p">,</span> <span class="n">block1</span><span class="p">),</span>
                <span class="n">seq_cluster</span><span class="p">(</span><span class="n">layers2</span><span class="p">,</span> <span class="n">block2</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_items</span><span class="p">(</span><span class="o">*</span><span class="n">object_connections</span><span class="p">(</span><span class="n">conns</span><span class="p">))</span>
<span class="n">g</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-3-d433d522f933&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> g = graph_items(seq_cluster(layers1, block1),
</span><span class="ansi-green-intense-fg ansi-bold">      2</span>                 seq_cluster(layers2, block2))
<span class="ansi-green-intense-fg ansi-bold">      3</span> g<span class="ansi-blue-fg">.</span>add_items<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>object_connections<span class="ansi-blue-fg">(</span>conns<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> g
<span class="ansi-green-intense-fg ansi-bold">      5</span> 

<span class="ansi-green-fg">~/PycharmProjects/fastdot/fastdot/core.py</span> in <span class="ansi-cyan-fg">seq_cluster</span><span class="ansi-blue-fg">(items, cluster_label, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    178</span> <span class="ansi-red-fg">#Cell</span>
<span class="ansi-green-intense-fg ansi-bold">    179</span> <span class="ansi-green-fg">def</span> seq_cluster<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">,</span> cluster_label<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 180</span><span class="ansi-red-fg">     </span>sg <span class="ansi-blue-fg">=</span> Cluster<span class="ansi-blue-fg">(</span>cluster_label<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    181</span>     its <span class="ansi-blue-fg">=</span> sg<span class="ansi-blue-fg">.</span>add_items<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>items<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    182</span>     sg<span class="ansi-blue-fg">.</span>add_edges_seq<span class="ansi-blue-fg">(</span>its<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/PycharmProjects/fastdot/fastdot/core.py</span> in <span class="ansi-cyan-fg">Cluster</span><span class="ansi-blue-fg">(obj, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     82</span>     <span class="ansi-blue-fg">&#34;Create a `pydot.Cluster` with a unique name&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">     83</span>     kwargs <span class="ansi-blue-fg">=</span> merge<span class="ansi-blue-fg">(</span>cluster_defaults<span class="ansi-blue-fg">,</span> kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 84</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> _pydot_create<span class="ansi-blue-fg">(</span>pydot<span class="ansi-blue-fg">.</span>Cluster<span class="ansi-blue-fg">,</span> obj<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     85</span> 
<span class="ansi-green-intense-fg ansi-bold">     86</span> <span class="ansi-red-fg">#Cell</span>

<span class="ansi-green-fg">~/PycharmProjects/fastdot/fastdot/core.py</span> in <span class="ansi-cyan-fg">_pydot_create</span><span class="ansi-blue-fg">(f, obj, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     40</span> <span class="ansi-green-fg">def</span> _pydot_create<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> obj<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     41</span>     <span class="ansi-green-fg">for</span> k<span class="ansi-blue-fg">,</span>v <span class="ansi-green-fg">in</span> kwargs<span class="ansi-blue-fg">.</span>items<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 42</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">if</span> callable<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> v <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> v<span class="ansi-blue-fg">(</span>obj<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     43</span>         <span class="ansi-green-fg">if</span> k <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">in</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;name&#39;</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;graph_name&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> kwargs<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> quote<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     44</span>     <span class="ansi-green-fg">return</span> add_mapping<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> obj<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/PycharmProjects/fastdot/fastdot/core.py</span> in <span class="ansi-cyan-fg">uniq_name</span><span class="ansi-blue-fg">(o)</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span> 
<span class="ansi-green-intense-fg ansi-bold">     18</span> <span class="ansi-red-fg">#Cell</span>
<span class="ansi-green-fg">---&gt; 19</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">def</span> uniq_name<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">&#39;n&#39;</span><span class="ansi-blue-fg">+</span><span class="ansi-blue-fg">(</span>uuid4<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>hex<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     20</span> 
<span class="ansi-green-intense-fg ansi-bold">     21</span> <span class="ansi-green-fg">def</span> quote<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> q<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;&#34;&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">NameError</span>: name &#39;uuid4&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See the <em>symbolic graphs</em> and <em>object graphs</em> sections below for a more complete example.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="fastdot-overview">fastdot overview<a class="anchor-link" href="#fastdot-overview"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>fastdot</code> is a thin wrapper over the excellent <a href="https://github.com/pydot/pydot">pydot</a> program (which is in turn a thin wrapper over the absolutely wonderful <a href="https://www.graphviz.org/">Graphviz software</a>), designed to make it more consistent, unsurprising, and pythonic. (An example of removing <em>surprise</em>: <code>pydot.Node('node')</code> gives an obscure compilation exception, since <code>node</code> is a keyword in the underlying <code>graphviz</code> program, whereas <code>fastdot.Node('node')</code> works just fine, due to auto-quoting.) In fact, you never need to provide names in <code>fastdot</code>; you can create edges directly between objects.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's a quick example of some of the main functionality:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">Dot</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">(</span><span class="s1">&#39;cl&#39;</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="s1">&#39;pink&#39;</span><span class="p">)</span>
<span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">add_items</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">add_items</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">a2</span><span class="p">),</span> <span class="n">a2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="s1">&#39;Check tooltip&#39;</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;I have a tooltip!&quot;</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="n">g</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you see, graphs know how to show themselves in Jupyter notebooks directly and can be exported to HTML (it uses SVG behind the scenes). Tooltips appear in both notebooks and exported HTML pages. Nodes with the same label, by default, are set to the same color. Also, as shown above, you can just use <code>add_item</code> or <code>add_items</code>, regardless of the type of item.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Symbolic-graphs">Symbolic graphs<a class="anchor-link" href="#Symbolic-graphs"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>fastdot</code> is particularly designed to make it easier to create graphs symbolically - for instance, for Python dictionaries, PyTorch/TensorFlow models, and so forth. Here's a simple example with some mock neural network layers and sequential models. First, let's define our mock classes:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Layer</span><span class="p">:</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">;</span> <span class="n">n_filters</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span>
<span class="k">class</span> <span class="nc">Linear</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span> <span class="k">pass</span>
<span class="k">class</span> <span class="nc">Conv2d</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span> <span class="k">pass</span>

<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Sequential</span><span class="p">:</span> <span class="n">layers</span><span class="p">:</span><span class="nb">list</span><span class="p">;</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's our sequential blocks for our "model":</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">block1</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span><span class="n">Conv2d</span><span class="p">(</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">Linear</span><span class="p">(</span><span class="s1">&#39;lin&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="s1">&#39;block1&#39;</span><span class="p">)</span>
<span class="n">block2</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span><span class="n">Conv2d</span><span class="p">(</span><span class="s1">&#39;conv1&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">Conv2d</span><span class="p">(</span><span class="s1">&#39;conv2&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Linear</span><span class="p">(</span><span class="s1">&#39;lin&#39;</span><span class="p">)],</span> <span class="s1">&#39;block2&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>fastdot</code> can create all node properties directly from objects; you just have to define functions describing how to map the object's attributes to graph properties. These mappings go in the <a href="/fastdot/core.html#node_defaults"><code>node_defaults</code></a> and <a href="/fastdot/core.html#cluster_defaults"><code>cluster_defaults</code></a> dictionaries (although by default labels are set using <code>str()</code>, so we don't need any special cluster defaults in this case):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">node_defaults</span><span class="p">[</span><span class="s1">&#39;fillcolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="s1">&#39;greenyellow&#39;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span><span class="n">Linear</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;pink&#39;</span>
<span class="n">cluster_defaults</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_defaults</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrgetter</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="n">node_defaults</span><span class="p">[</span><span class="s1">&#39;tooltip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With that in place, we can directly create nodes from our objects, for instance using the convenient <a href="/fastdot/core.html#seq_cluster"><code>seq_cluster</code></a> function:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c1</span> <span class="o">=</span> <span class="n">seq_cluster</span><span class="p">(</span><span class="n">block1</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span> <span class="n">block1</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">seq_cluster</span><span class="p">(</span><span class="n">block2</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span> <span class="n">block2</span><span class="p">)</span>
<span class="n">e1</span><span class="p">,</span><span class="n">e2</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">c2</span><span class="p">),</span><span class="n">c1</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">last</span><span class="p">())</span>
<span class="n">graph_items</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that in this example we didn't even need to create the <a href="/fastdot/core.html#Dot"><code>Dot</code></a> object separately - <a href="/fastdot/core.html#graph_items"><code>graph_items</code></a> creates it directly from the graph items provided.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-object-graphs">Using object graphs<a class="anchor-link" href="#Using-object-graphs"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the above example, we defined our edges directly between <code>fastdot</code> objects. In practice, however, you'll most likely have your edges defined directly between python objects, for instance like this:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">conns</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">block1</span><span class="p">,</span> <span class="n">block2</span><span class="p">),</span>
    <span class="p">(</span><span class="n">block1</span><span class="p">,</span> <span class="n">block2</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this case, you'll want some way to connect your python objects to the <code>fastdot</code> graph items that represent them. A mapping is stored automatically by <code>fastdot</code>, and is made available through the <a href="/fastdot/core.html#object2graph"><code>object2graph</code></a> function:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">graph_items</span><span class="p">(</span><span class="n">seq_cluster</span><span class="p">(</span><span class="n">block1</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span> <span class="n">block1</span><span class="p">),</span> <span class="n">seq_cluster</span><span class="p">(</span><span class="n">block2</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span> <span class="n">block2</span><span class="p">))</span>
<span class="n">object2graph</span><span class="p">(</span><span class="n">block1</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can use this to graph your connections without needing access to the graph items:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">add_items</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">object2graph</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">object2graph</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
              <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">conns</span><span class="p">])</span>
<span class="n">g</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There's a helper function, <a href="/fastdot/core.html#object_connections"><code>object_connections</code></a>, which creates these connections for you. So the above can be simplified to:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">graph_items</span><span class="p">(</span><span class="n">seq_cluster</span><span class="p">(</span><span class="n">block1</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span> <span class="n">block1</span><span class="p">),</span> <span class="n">seq_cluster</span><span class="p">(</span><span class="n">block2</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span> <span class="n">block2</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_items</span><span class="p">(</span><span class="o">*</span><span class="n">object_connections</span><span class="p">(</span><span class="n">conns</span><span class="p">))</span>
<span class="n">g</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

